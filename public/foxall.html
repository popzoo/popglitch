<!DOCTYPE html>
<html>

<head>
    <title>小妲己</title>
    <meta name="keywords" content="小妲己,小奶猫" />
    <meta name="description" content="小妲己,小奶猫" />
    <meta name="robots" content="index,follow"/>
    <meta name="author" content="lvlanxing"/>
    <meta name="google" value="notranslate"/>
    <!-- 网页控制 -->
    <meta name="referrer" content="no-referrer"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="Access-Control-Allow-Origin" content="*"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <!-- <link rel="shortcut icon" href="/img/favicon.ico"/> -->
    <link rel="shortcut icon" href="https://lvsfbqec.shdkw1o.com/favicon.ico">
    <!-- <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/popzoo/pop/images/favicon.ico"> -->
    <!-- iphone suitable -->
    <meta name="theme-color" content="#000000"/>
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=0.8,maximum-scale=1.0,minimum-scale=0.3"/>
    <link rel="apple-touch-icon" href="https://lvsfbqec.shdkw1o.com/favicon.ico"/>
    <meta name="apple-mobile-web-app-title" content="小妲己"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="format-detection" content="email=no"/>     
    <link rel="stylesheet" href="./css/pop_page.css">
</head>

<body>
    <a id="left_link" href="https://github.com/xqf8188/wksj/blob/c128620f5301b41c87a62b42d836570fd8c39f76/xdj.js"
        class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250"
            style="fill:#64CEAA; color:#fff; position: fixed; top: 0; border: 0; left: 0; transform: scale(-1, 1);z-index: 10;"
            aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg></a>
    <a id="right_link" href="#" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80"
            viewbox="0 0 250 250"
            style="fill:#70B7FD; color:#fff; position: fixed; top: 0; border: 0; right: 0;z-index: 100;"
            aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body"></path>
        </svg></a>
    <style>
        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out
        }
        @keyframes octocat-wave {
            0%,
            100% {
                transform: rotate(0)
            }
            20%,
            60% {
                transform: rotate(-25deg)
            }
            40%,
            80% {
                transform: rotate(10deg)
            }
        }
        @media (max-width:500px) {
            .github-corner:hover .octo-arm {
                animation: none
            }
            .github-corner .octo-arm {
                animation: octocat-wave 560ms ease-in-out
            }
        }
    </style>
    <div style="text-align: center; font-size: 30px;margin: 20px 0 10px 0;">💖诱惑小妲己💖</div>
    <div
        style=" height:30px; color:#3C3C3C; line-height:30px; text-align: center; font-size:30px; font-family: Arial,Microsoft YaHei,'宋体';">
        <span class="collapse" style="float: center;white-space: nowrap; font-size: 21px;color:#4D4D4D;">
            <a class="nav-link" id="own_hot" style="text-decoration:none;" href="#">热门</a> •
            <a class="nav-link" id="own_near" style="text-decoration:none;" href="#">附近</a> •
            <a class="nav-link" id="own_face" style="text-decoration:none;" href="#">颜值</a> •
            <a class="nav-link" id="own_vip" style="text-decoration:none;" href="#">VIP</a> •
            <a class="nav-link" id="own_last" style="text-decoration:none;" href="#">最新</a>
        </span>
    </div>
    <div class="content">
        <div id="device" class="gridalicious">
            <div class="galcolumn">
                <!--    <div class="item"><img src="images/1.jpg" alt="pic_ins"/><p>Virgin Girl</p></div>  -->
            </div>
        </div>
    </div>
    <div id="rocket-to-top">
        <div style="opacity: 0; display: block;" class="level-2"></div>
        <div class="level-3"></div>
    </div>
    <!-- loading按钮自己通过样式调整 -->
    <footer id="loading"
        style="width:300px;height:30px;line-height:30px;font-size:18px;text-align:center;border-radius:3px;opacity:0.8;background:#BBBBBB;margin:10px auto 30px;color:black;">
        加载中...
    </footer>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="./js/jquery.grid-a-licious.min.js"></script>
    <script type="text/javascript" src="./js/rocket.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JG6PBMLH1B"></script>
    <script type="text/javascript">
        var count = 0, roomList = [], loadingFlag = false, onlineHost = 0;
        var serverUrl = document.location.protocol+"//"+document.domain;
        var staticLink = sessionStorage.getItem('staticLink') != null ? sessionStorage.getItem('staticLink') : null;//'https://cdn.yywyq.com';
        var mobileLink = sessionStorage.getItem('mobileLink') != null ? sessionStorage.getItem('mobileLink') : null;//'https://reir.xyz';
        var radioObj = sessionStorage.getItem("RenderStatus") != null ? sessionStorage.getItem("RenderStatus") : "own_hot";
        (function ctrlBackEffect() {
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-JG6PBMLH1B');            
            var scriptNode = document.createElement("script");
            scriptNode.setAttribute("type", "text/javascript");
            if (localStorage.getItem('showBack') != 'off') {
                scriptNode.setAttribute("src", "./js/spider-background.js");
                document.body.appendChild(scriptNode);
            }
        })();
        (function initProgram() {
            document.getElementById(radioObj).style.color = 'orange';
            document.getElementById("own_hot").addEventListener("click", (function () {
                btnClickEvent('own_hot')
            }));
            document.getElementById("own_last").addEventListener("click", (function () {
                btnClickEvent('own_last')
            }));
            document.getElementById("own_vip").addEventListener("click", (function () {
                btnClickEvent('own_vip')
            }));
            document.getElementById("own_face").addEventListener("click", (function () {
                btnClickEvent('own_face')
            }));
            document.getElementById("own_near").addEventListener("click", (function () {
                btnClickEvent('own_near')
            }));
            loadingEffect();
            renewStaticLink();
            renewMobileLink();
            // getDataList(1);
        })();
        function btnClickEvent(msg) {
            sessionStorage.setItem("RenderStatus", msg);
            location.reload();
        }
        function loadingEffect(step) {
            if (!loadingFlag) {
                switch (step) {
                    case 0:
                        document.getElementById("loading").innerHTML = "⚡嗑药加载中⚡";
                        setTimeout(() => { loadingEffect(1) }, 400);
                        break;
                    case 1:
                        document.getElementById("loading").innerHTML = "⚡⚡吐血加载中⚡⚡";
                        setTimeout(() => { loadingEffect(2) }, 600);
                        break;
                    case 2:
                        document.getElementById("loading").innerHTML = "⚡⚡⚡切腹加载中⚡⚡⚡";
                        setTimeout(() => { loadingEffect() }, 600);
                        break;
                    default:
                        document.getElementById("loading").innerHTML = "玩命加载中";
                        setTimeout(() => { loadingEffect(0) }, 400);
                        break;
                }
            }
        }
        function getDataList(page) {
            let reqUrl = serverUrl;
            if (radioObj == 'own_hot') {
                reqUrl += '/api/hot?page='+page;//这里需要实现分页加载功能============================
            } else if (radioObj == 'own_near') {
                reqUrl += '/api/nearby?page='+page;                
            } else if (radioObj == 'own_face') {
                reqUrl += '/api/vegan?page='+page;
            } else if (radioObj == 'own_vip') {
                reqUrl += '/api/vip?page='+page;
            } else if (radioObj == 'own_last') {
                reqUrl += '/api/latest';                   
            }
            fetch(reqUrl, {
                method: 'GET',
                mode: 'cors',
                cache: 'default',
                // headers: {
                //     'Authorization': getCookie('token')
                // },
                credentials: 'omit'
            }).then(result => {
                return result.json();
            }).then(json => {
                if (json != undefined && json.list != undefined) {
                    onlineHost = json.row_count;
                    pageCount = json.page_count;                    
                    roomList = [].concat(json.list);
                    $("#device").gridalicious('append', makeFireBoxes());//注意这里是append追加，分页roomList要清空
                    if(page<pageCount){
                        getDataList(++page);
                    }
                } else {
                    alert('Json Data Lost or Invalid Token');
                    console.error('Json Data Lost!');
                }
            }).catch(err => {
                console.error('ERROR', err);
            })
        }
        function renewStaticLink() {
            if (staticLink == null) {
                fetch(serverUrl + '/api/appconf', {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'default',
                    credentials: 'omit'
                }).then(result => {
                    return result.json();
                }).then(json => {
                    if (json != undefined && json.code == 0) {
                        staticLink = json.data.host.static;
                        sessionStorage.setItem('staticLink', json.data.host.static);
                    } else {
                        staticLink = 'https://cdn.yywyq.com';
                    }
                    getDataList(1);
                }).catch(err => {
                    console.error('ERROR', err);
                    staticLink = 'https://cdn.yywyq.com';
                    getDataList(1);
                })
            } else {
                getDataList(1);
            }
        }
        function renewMobileLink() {
            if (mobileLink == null) {
                fetch(serverUrl + '/api/appver', {
                    method: 'GET',
                    mode: 'cors',
                    cache: 'default',
                    credentials: 'omit'
                }).then(result => {
                    return result.json();
                }).then(json => {
                    if (json != undefined && json.code == 0) {
                        sessionStorage.setItem('mobileLink', json.data.apk_web);
                        document.getElementById('right_link').href = json.data.apk_web;
                    }
                }).catch(err => {
                    console.error('ERROR', err);
                })
            } else {
                document.getElementById('right_link').href = mobileLink;
            }
        }
        //===============================================================
        //+++++++++++++++++ 模拟滚动条滚动时随机添加内容 +++++++++++++++++
        //===============================================================            
        function makeFireBoxes() {
            var boxes = new Array;
            var uidList = [];
            for (let j = 0; j < roomList.length; j++) {
                if (roomList[j].is_scroll) { //true 为真人，false为广告
                    let city = roomList[j].city != undefined ? roomList[j].city.substr(0, 3) : '保密';
                    let div = $('<div></div>').addClass('item');
                    let content = "<a href = '" + serverUrl + "/room/" + roomList[j].id + "'target = '_blank' > <img src='" + staticLink + roomList[j].snap + "' />";
                    // onclick='openDetailRoom(" + roomList[j].id +")' target='_blank'><img src='https://fakeimg.pl/220x300/282828/FFA273/?text=%E6%9A%82%E6%97%A0%E5%9B%BE%E7%89%87&font=noto'/>";
                    content += "<p>标题:<strong style='color:blue;'>" + roomList[j].nickname +
                        "</strong>&nbsp;&nbsp;城市:<strong style='color:#cd00cd;'>" + city + "</strong></p>";
                    content += "<p>房号:<strong style='color:green;'>" + roomList[j].id +
                        "</strong>&nbsp;&nbsp;人气:<strong style='color:red;'>" + roomList[j].online + "</strong></p></a>";
                    div.append(content);
                    boxes.push(div);
                    uidList.push(roomList[j].id);
                    ++count;
                }
            }
            sessionStorage.setItem('uidRenew', new Date().getTime().toString());
            sessionStorage.setItem('uidList', JSON.stringify(uidList));
            loadingFlag = true;
            $('#loading').text('👒Online『' + onlineHost + '』 💖Current『' + count + "』");
            return boxes;
        }
        // function openDetailRoom(roomId) {
        //     sessionStorage.setItem('roomId', roomId);
        //     window.open('detail.html'); //这里需要跟换为详细页面路由
        // }
        //滚动条事件
        $(document).ready(function () {
            $(window).scroll(function () {
                if (($(window).scrollTop() + $(window).height()) >= $(document).height() - 50) {
                    // if(radioObj === "all_fire"|| radioObj==="all_welfare"){
                    // $("#device").gridalicious('append', makeFireBoxes());
                    // }
                }
            });
            //主要部分
            $("#device").gridalicious({
                gutter: 20, //缝隙宽度
                width: 240, //图片宽度
                animate: true, //启用动画
                animationOptions: {
                    speed: 100,
                    duration: 200,
                    queue: false, //同步显示
                    complete: function (data) { }
                },
            });
        });
        // ===================================================================
        // time format util
        function dateFormat(fmt, date) {
            let ret;
            let opt = {
                "Y+": date.getFullYear().toString(),
                "m+": (date.getMonth() + 1).toString(),
                "d+": date.getDate().toString(),
                "H+": date.getHours().toString(),
                "M+": date.getMinutes().toString(),
                "S+": date.getSeconds().toString()
            };
            for (let k in opt) {
                ret = new RegExp("(" + k + ")").exec(fmt);
                if (ret) {
                    fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, "0")))
                };
            };
            return fmt;
        }
        // set cookie
        function setCookie(name, value) {
            //document.cookie.setPath("/");
            var exp = new Date();
            exp.setTime(exp.getTime() + 30 * 24 * 60 * 60 * 1000);
            document.cookie = name + "=" + escape(value) + ";  path=/; expires=" + exp.toGMTString();
        }
        // get cookie
        function getCookie(name) {
            //document.cookie.setPath("/");
            var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
            return (arr = document.cookie.match(reg)) ? unescape(arr[2]) : null;
        }
        // del cookie
        function delCookie(name) {
            var exp = new Date();
            exp.setTime(exp.getTime() - 1);
            var cval = getCookie(name);
            if (cval != null) document.cookie = name + "=" + cval + "; path=/; expires=" + exp.toGMTString();
        }
        function isValidIP(ip) {
            var reg = /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/
            return reg.test(ip);
        }        
    </script>
</body>

</html>